@page
@model Project_Echo.Pages.ConvertModel
@{
    ViewData["Title"] = "Media Converter";
}

@section Styles {
    <link rel="stylesheet" href="~/css/site.min.css" asp-append-version="true" />
}

<div class="base64-page">
    <div class="page-container">
        <div class="page-title">
            <h1>Media Converter<span class="underscore">_</span></h1>
            <p class="subheading">Download or convert media using yt-dlp and ffmpeg</p>
        </div>

        @if (!string.IsNullOrWhiteSpace(Model.ErrorMessage))
        {
            <div class="alert" style="color:#ff6b6b; margin-bottom:16px;">@Model.ErrorMessage</div>
        }

        <!-- Download by URL -->
        <div class="section">
            <h2>
                <i class="fas fa-link"></i>
                Download by URL
            </h2>
            <form method="post" asp-page-handler="Download">
                <input type="hidden" name="handler" value="Download" />
                <div class="form-group" style="margin-bottom:12px;">
                    <label for="Url">Source URL</label>
                    <input type="url" id="Url" name="Url" value="@Model.Url" class="textarea" placeholder="https://..." required />
                </div>
                <div class="form-group" style="margin-bottom:12px;">
                    <label for="DownloadType">Type</label>
                    <select id="DownloadType" name="DownloadType" class="textarea">
                        <option value="video" selected>Video</option>
                        <option value="audio">Audio</option>
                    </select>
                </div>
                <div class="form-group" style="margin-bottom:12px;">
                    <label for="Format">Format</label>
                    <select id="Format" name="Format" class="textarea">
                        <option value="mp4" selected>mp4</option>
                        <option value="webm">webm</option>
                        <option value="mp3">mp3</option>
                        <option value="opus">opus</option>
                        <option value="best">best (auto)</option>
                    </select>
                </div>
                <button type="submit" class="btn">
                    <i class="fas fa-download"></i> Start Download
                </button>
            </form>
        </div>

        <!-- Convert local file -->
        <div class="section">
            <h2>
                <i class="fas fa-exchange-alt"></i>
                Convert Local File
            </h2>
            <form method="post" enctype="multipart/form-data" asp-page-handler="Convert">
                <input type="hidden" name="handler" value="Convert" />
                <div class="form-group" style="margin-bottom:12px;">
                    <label for="Upload">Choose file</label>
                    <input type="file" id="Upload" name="Upload" class="file-input" required />
                </div>
                <div class="form-group" style="margin-bottom:12px;">
                    <label for="TargetFormat">Target format</label>
                    <select id="TargetFormat" name="TargetFormat" class="textarea">
                        <option value="mp4" selected>mp4</option>
                        <option value="mp3">mp3</option>
                        <option value="wav">wav</option>
                        <option value="webm">webm</option>
                        <option value="ogg">ogg</option>
                    </select>
                </div>
                <button type="submit" class="btn">
                    <i class="fas fa-sync"></i> Convert
                </button>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    <script src="~/js/convert.js" asp-append-version="true"></script>
}


